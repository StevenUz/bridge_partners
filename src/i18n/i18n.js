const STORAGE_KEY = 'bridge-partners-language';

export const languages = {
  en: 'English',
  bg: 'Български'
};

const translations = {
  en: {
    brand: 'Bridge Partners',
    navHome: 'Home',
    navLobby: 'Lobby',
    navTable: 'Table View',
    navStats: 'Statistics',
    navObserver: 'Observer',
    language: 'Language',
    heroTitle: 'Play Bridge With Partners Anywhere',
    heroSubtitle: 'Register, join a lobby, sit at a table, and start the deal.',
    ctaRegister: 'Register & Enter Lobby',
    ctaSignIn: 'Sign In',
    formName: 'Display Name',
    formEmail: 'Email Address',
    formPassword: 'Password',
    formRemember: 'Remember me on this device',
    registrationRequired: 'Please fill in all fields',
    registrationFailed: 'Registration failed',
    usernameOrEmailExists: 'Username or email already exists',
    loginRequired: 'Please enter username and password',
    invalidCredentials: 'Invalid username or password',
    lobbyTitle: 'Lobby',
    lobbyCreate: 'Create New Table',
    lobbyLimit: 'Up to 5 active tables',
    lobbyLimitReached: 'Table limit reached',
    lobbyLimitMessage: 'All 5 tables are currently active. Please wait for a spot to open up, or join an existing table as a player or observer.',
    lobbyAvailable: 'Available Tables',
    table: 'Table',
    tableSeats: 'Seats',
    tablePlayers: 'Players',
    tableObservers: 'Observers',
    tableJoin: 'Join Table',
    tableJoinAs: 'Join as',
    observe: 'Observe',
    yourPosition: 'Your Position',
    observerMode: 'Observer Mode',
    chatLobby: 'Lobby chat',
    chatTable: 'Table chat',
    chatPlaceholder: 'Type a message (max 50 chars)',
    chatSend: 'Send',
    changePosition: 'Change perspective - click to see from another player\'s view',
    cards: 'cards',
    dealCards: 'Deal Cards',
    biddingTitle: 'Bidding',
    biddingTurn: 'Turn',
    biddingHistory: 'History',
    biddingEnded: 'Bidding ended',
    pass: 'Pass',
    double: 'Double',
    redouble: 'Redouble',
    dealer: 'Dealer',
    hcpBottom: 'Bottom points',
    hcpTop: 'Top points',
    hcpLeft: 'Left points',
    hcpRight: 'Right points',
    hcpSouth: 'South points',
    hcpNorth: 'North points',
    hcpWest: 'West points',
    hcpEast: 'East points',
    seatSouth: 'South',
    seatWest: 'West',
    seatNorth: 'North',
    seatEast: 'East',
    seatShortSouth: 'S',
    seatShortWest: 'W',
    seatShortNorth: 'N',
    seatShortEast: 'E',
    seatOpen: 'Open',
    seatObserver: 'Observer',
    tableViewTitle: 'Table View',
    tableStatusWaiting: 'Waiting for four players to start dealing.',
    statisticsTitle: 'Statistics',
    statisticsComingSoon: 'Player stats, boards, and scores will live here.',
    partnersTitle: 'Partnerships',
    participationTitle: 'Game Participation',
    contractsTitle: 'Contract Success',
    scoringTitle: 'Points & Slams',
    playerCol: 'Player',
    partnerCol: 'Partner',
    gamesCol: 'Games',
    winsCol: 'Wins',
    winRateCol: 'Win %',
    totalGamesCol: 'Total',
    declarerCol: 'Decl',
    dummyCol: 'Dmmy',
    defenderCol: 'Def',
    madeCol: 'Made',
    failedCol: 'Failed',
    defeatCol: 'Defeat',
    defeatPctCol: 'Def%',
    scoreCol: 'Score',
    smallSlamsCol: 'SSl',
    grandSlamsCol: 'GSl',
    languagePicker: 'Choose language',
    saveLanguage: 'Save language',
    vulnerable: 'Vulnerable',
    notVulnerable: 'Not Vulnerable',
    vulnerableShort: 'V',
    notVulnerableShort: 'NV'
  },
  bg: {
    brand: 'Bridge Partners',
    navHome: 'Начало',
    navLobby: 'Лоби',
    navTable: 'Маса',
    navStats: 'Статистика',
    navObserver: 'Наблюдател',
    language: 'Език',
    heroTitle: 'Играйте бридж с партньори навсякъде',
    heroSubtitle: 'Регистрирайте се, влезте в лоби, седнете на маса и започнете раздаването.',
    ctaRegister: 'Регистрация и вход в лобито',
    ctaSignIn: 'Вход',
    formName: 'Име за показване',
    formEmail: 'Имейл адрес',
    formPassword: 'Парола',
    formRemember: 'Запомни ме на това устройство',
    registrationRequired: 'Моля, попълнете всички полета',
    registrationFailed: 'Регистрацията неудачна',
    usernameOrEmailExists: 'Потребителското име или имейлът вече съществува',
    loginRequired: 'Моля, въведете потребителско име и парола',
    invalidCredentials: 'Невалидни потребителско име или парола',
    lobbyTitle: 'Лоби',
    lobbyCreate: 'Нова маса',
    lobbyLimit: 'До 5 активни маси',
    lobbyLimitReached: 'Достигнат лимит на маси',
    lobbyLimitMessage: 'Всички 5 маси са заети в момента. Моля, изчакайте да се освободи място или се присъединете към съществуваща маса като играч или наблюдател.',
    lobbyAvailable: 'Свободни маси',
    table: 'Маса',
    tableSeats: 'Места',
    tablePlayers: 'Играчи',
    tableObservers: 'Наблюдатели',
    tableJoin: 'Влез на масата',
    tableJoinAs: 'Влез като',
    observe: 'Наблюдавай',
    yourPosition: 'Вашата позиция',
    observerMode: 'Режим на наблюдател',
    chatLobby: 'Чат в лобито',
    chatTable: 'Чат за масата',
    chatPlaceholder: 'Въведи съобщение (до 50 символа)',
    chatSend: 'Изпрати',
    changePosition: 'Промени перспектива - кликни, за да видиш от друг играч',
    cards: 'карти',
    dealCards: 'Раздай картите',
    biddingTitle: 'Залагане',
    biddingTurn: 'Ред',
    biddingHistory: 'История',
    biddingEnded: 'Залагането приключи',
    pass: 'Пас',
    double: 'Контра',
    redouble: 'Реконтра',
    dealer: 'Раздаващ',
    hcpBottom: 'Точки (долу)',
    hcpTop: 'Точки (горе)',
    hcpLeft: 'Точки (ляво)',
    hcpRight: 'Точки (дясно)',
    hcpSouth: 'Точки на Юг',
    hcpNorth: 'Точки на Север',
    hcpWest: 'Точки на Запад',
    hcpEast: 'Точки на Изток',
    seatSouth: 'Юг',
    seatWest: 'Запад',
    seatNorth: 'Север',
    seatEast: 'Изток',
    seatShortSouth: 'Ю',
    seatShortWest: 'З',
    seatShortNorth: 'С',
    seatShortEast: 'И',
    seatOpen: 'Свободно',
    seatObserver: 'Наблюдател',
    tableViewTitle: 'Изглед на маса',
    tableStatusWaiting: 'Изчакват се четирима играчи за старт.',
    statisticsTitle: 'Статистика',
    statisticsComingSoon: 'Тук ще бъдат резултати, бордове и точки.',
    partnersTitle: 'Партньорства',
    participationTitle: 'Участие в игри',
    contractsTitle: 'Успех на договори',
    scoringTitle: 'Точки и шлемове',
    playerCol: 'Играч',
    partnerCol: 'Партньор',
    gamesCol: 'Игри',
    winsCol: 'Побе',
    winRateCol: 'Win %',
    totalGamesCol: 'Всич',
    declarerCol: 'Раз',
    dummyCol: 'Мор',
    defenderCol: 'Защ',
    madeCol: 'Изка',
    failedCol: 'Неиз',
    defeatCol: 'Вкар',
    defeatPctCol: 'Def%',
    scoreCol: 'Точ',
    smallSlamsCol: 'МШл',
    grandSlamsCol: 'ГШл',
    languagePicker: 'Избери език',
    saveLanguage: 'Запази езика',
    vulnerable: 'В Зона',
    notVulnerable: 'Без Зона',
    vulnerableShort: 'З',
    notVulnerableShort: 'БЗ'
  }
};

export function getLanguage() {
  const stored = localStorage.getItem(STORAGE_KEY);
  return stored && languages[stored] ? stored : 'en';
}

export function setLanguage(language) {
  const value = languages[language] ? language : 'en';
  localStorage.setItem(STORAGE_KEY, value);
  return value;
}

export function t(language, key) {
  const lang = languages[language] ? language : 'en';
  return translations[lang][key] ?? translations.en[key] ?? key;
}

export function applyTranslations(root, language) {
  if (!root) return;
  root.querySelectorAll('[data-i18n]').forEach((node) => {
    const key = node.getAttribute('data-i18n');
    node.textContent = t(language, key);
  });
}
